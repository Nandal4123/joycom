rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // ==========================================
    // ğŸ¥ ìƒë‹´ì‹ ì²­ì„œ ì»¬ë ‰ì…˜ (consultations)
    // ==========================================
    match /consultations/{document} {
      // ìƒì„±: ëª¨ë“  ì‚¬ìš©ì í—ˆìš© (ìƒë‹´ì‹ ì²­ì„œ ì œì¶œ)
      allow create: if validateConsultationData(request.resource.data);
      
      // ì½ê¸°: ê°œë°œ/í…ŒìŠ¤íŠ¸ìš© í—ˆìš© (ì¶”í›„ ê´€ë¦¬ìë§Œ ê°€ëŠ¥í•˜ë„ë¡ ë³€ê²½)
      allow read: if true;
      
      // ìˆ˜ì •: ìƒíƒœ ì—…ë°ì´íŠ¸ë§Œ í—ˆìš©
      allow update: if validateStatusUpdate(request.resource.data, resource.data);
      
      // ì‚­ì œ: ì œí•œ (ê´€ë¦¬ìë§Œ)
      allow delete: if false;
    }
  }
}

// ì´ ê·œì¹™ì€ ê°œë°œ ë‹¨ê³„ì—ì„œë§Œ ì‚¬ìš©í•˜ê³ ,
// ì‹¤ì œ ë°°í¬ ì‹œì—ëŠ” firestore.rulesì˜ ë³´ì•ˆ ê·œì¹™ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. 