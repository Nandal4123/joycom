# 🔐 관리자 계정 설정 가이드

## 📋 **관리자 인증 시스템 개요**

조이상담코칭센터 관리자 페이지는 **2단계 보안 인증**을 사용합니다:

1. **Firebase Auth 로그인** (이메일 + 비밀번호)
2. **관리자 권한 확인** (허용된 이메일 목록)

---

## 🛠️ **관리자 계정 설정 방법**

### **1단계: Firebase 콘솔에서 관리자 계정 생성**

```
🔗 Firebase 콘솔: https://console.firebase.google.com/project/joy-counseling-center/authentication/users

📋 설정 과정:
1. Authentication → Users 탭 클릭
2. "사용자 추가" 버튼 클릭
3. 관리자 정보 입력:
   - 이메일: admin@joycom.or.kr
   - 비밀번호: [강력한 비밀번호 설정]
4. "사용자 추가" 클릭
```

### **2단계: 허용된 관리자 이메일 목록 확인**

현재 코드에서 허용된 관리자 이메일:
```javascript
const ADMIN_EMAILS = [
    'admin@joycom.or.kr',     // 메인 관리자
    'manager@joycom.or.kr',   // 매니저
    'counselor@joycom.or.kr'  // 상담사
];
```

### **3단계: 추가 관리자 계정 생성 (필요시)**

위 목록의 다른 이메일들도 Firebase에서 동일하게 생성하면 됩니다.

---

## 🔒 **보안 기능**

### **접근 제한**
```
✅ 허용된 이메일만 로그인 가능
✅ 일반 사용자 접근 시 자동 차단
✅ 권한 없는 계정은 강제 로그아웃
✅ 상세한 오류 메시지로 상황 안내
```

### **인증 흐름**
```
1. 사용자가 admin.html 접속
2. 로그인 화면 자동 표시
3. 이메일/비밀번호 입력
4. Firebase Auth 인증 확인
5. 관리자 이메일 목록 대조
6. 권한 있으면 관리자 화면 표시
7. 권한 없으면 접근 차단
```

### **자동 보호 기능**
```
🛡️ URL 직접 접근 차단
🛡️ 브라우저 새로고침 시에도 인증 유지
🛡️ 세션 만료 시 자동 로그아웃
🛡️ 여러 창에서 동시 인증 상태 동기화
```

---

## 🧪 **테스트 방법**

### **✅ 정상 접근 테스트**
```
1. http://localhost:8000/admin.html 접속
2. 관리자 계정으로 로그인:
   - 이메일: admin@joycom.or.kr
   - 비밀번호: [설정한 비밀번호]
3. 관리자 화면 표시 확인
4. 상담신청서 목록 로드 확인
```

### **❌ 비인가 접근 테스트**
```
1. 일반 사용자 계정으로 로그인 시도
2. "관리자 권한이 없습니다" 오류 확인
3. 자동 로그아웃 확인
4. 로그인 화면으로 복귀 확인
```

### **🔄 세션 관리 테스트**
```
1. 관리자로 로그인 후 새 탭 열기
2. admin.html 접속 시 자동 로그인 확인
3. 로그아웃 후 모든 탭에서 로그아웃 확인
4. 브라우저 새로고침 시 세션 유지 확인
```

---

## ⚠️ **보안 주의사항**

### **관리자 계정 관리**
```
🔐 강력한 비밀번호 사용 (영문+숫자+특수문자, 12자 이상)
🔐 정기적인 비밀번호 변경 (3개월마다)
🔐 관리자 계정 개인별 할당
🔐 퇴사자 계정 즉시 삭제
```

### **접근 환경**
```
🌐 안전한 네트워크에서만 접속
🌐 공용 컴퓨터 사용 금지
🌐 접속 후 반드시 로그아웃
🌐 브라우저 자동 저장 기능 비활성화
```

---

## 🔧 **고급 설정 (선택사항)**

### **Firestore 기반 관리자 관리**

현재는 코드에 하드코딩된 이메일 목록을 사용하지만, 
추후 Firestore 컬렉션으로 관리자 목록을 관리할 수 있습니다:

```javascript
// admins 컬렉션 구조
{
  "admin@joycom.or.kr": {
    "name": "메인 관리자",
    "role": "super_admin",
    "createdAt": "2024-01-01",
    "isActive": true
  }
}
```

### **역할 기반 권한 관리**

추후 관리자 역할별 권한 구분도 가능합니다:
```
- super_admin: 모든 권한
- manager: 상담신청서 관리만
- counselor: 조회 권한만
```

---

## 📞 **문제 해결**

### **로그인이 안 될 때**
```
1. 이메일이 ADMIN_EMAILS 목록에 있는지 확인
2. Firebase 콘솔에서 계정이 생성되어 있는지 확인
3. 비밀번호가 정확한지 확인
4. 브라우저 개발자 도구에서 오류 메시지 확인
```

### **권한 오류가 날 때**
```
1. 코드의 ADMIN_EMAILS 배열 확인
2. 이메일 주소 철자 정확히 입력
3. 대소문자 구분 확인
```

### **데이터가 안 보일 때**
```
1. Firestore 보안 규칙 배포 확인
2. 네트워크 연결 상태 확인
3. Firebase 프로젝트 설정 확인
```

---

## 🎯 **다음 단계**

1. **관리자 계정 생성** 및 테스트
2. **보안 정책** 수립 및 교육
3. **백업 관리자** 계정 준비
4. **정기 보안 점검** 일정 수립

관리자 시스템이 안전하게 구축되었습니다! 🔐✨ 